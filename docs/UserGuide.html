<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8" />
    <meta name="author" content="Francis Wright" />
    <title>Run-REDUCE-FX User Guide</title>
    <style>
      body {
          font-family: "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif;
          font-size: 12pt;
          max-width: 640px;
          margin-right: auto;
          margin-left: auto;
      }
      code {
          font-family: "Lucida Console", "Lucida Sans Typewriter", monospace;
      }
      h1, h2, h3 {
          font-family: "Lucida Bright", Georgia, Times, "Times New Roman", serif;
      }
      table {
          margin-right: auto;
          margin-left: auto;
      }
      td,th {
          padding-right: 10px;
          padding-left: 10px;
          text-align: left;
      }
    </style>
</head>
<body>
    <h1>Run-REDUCE-FX User Guide</h1>
    <h3>&copy; 2020 Francis Wright</h3>

    <h2>General Information</h2>

    <p>Run-REDUCE-FX remembers user preferences and uses them the next
    time it starts. It uses the standard Java
    package <em>java.util.prefs</em>, which stores data persistently
    in an implementation-dependent backing store. On Microsoft Windows
    the preferences for this application are stored in the registry
    under the key
    "<code>Computer\HKEY_CURRENT_USER\Software\JavaSoft\Prefs\fjwright\runreduce</code>"
    and on Linux they are stored in the XML file
    "<code>~/.java/.userPrefs/fjwright/runreduce/prefs.xml</code>".
    </p>
    <p>By default, Run-REDUCE-FX looks in the standard places for a
    REDUCE installation. On Microsoft Windows it looks for the folder
    "<code>\Program Files\Reduce</code>" on all accessible drives. On
    Linux it assumes that executable files are under
    "<code>/usr/lib/reduce</code>", package information is under
    "<code>/usr/share/reduce</code>", and documentation is under
    "<code>/usr/share/doc/reduce</code>". But this information can all
    be <a href="#Configure">reconfigured</a>.
    </p>

    <h2>The Main Window</h2>

    <p>The main window consists of one or more REDUCE panels that can
    each run an independent invocation of REDUCE. There are three
    options: a single REDUCE panel (the default); a split pane
    containing two REDUCE panels side-by-side that are both visible; a
    tabbed pane containing one or more REDUCE panels, of which only
    the selected panel is visible. The choice of display pane
    arrangement is controlled by options in
    the <a href="#ViewMenu">View menu</a>. You can switch dynamically
    among the three options, in which case the currently selected
    REDUCE panel (only) and the REDUCE invocation running in it (if
    any) is preserved and carried to the new display pane arrangement,
    but any other REDUCE invocations are discarded. With a split or
    tabbed pane, the active REDUCE panel can be selected by clicking
    on the desired panel in a split pane or tab on a tabbed pane. The
    non-selected panel in a split pane is greyed out. All controls and
    the <em>File</em> and <em>REDUCE</em> menus apply to the currently
    selected REDUCE panel, whereas the <em>View</em> menu applies to
    all REDUCE panels.
    </p>
    <p>Tabs are initially labelled <em>Tab 1</em>, <em>Tab 2</em>,
    etc., and a new tab is labelled <em>Tab n</em> if it is
    the <em>n<sup>th</sup></em> tab to be added. (Removing tabs does
    not affect the numbering.) However, when REDUCE is run in a tab,
    the tab label changes to the name of the REDUCE command being run,
    and remains so until a different REDUCE command is run in that
    tab.
    </p>
    <h3>REDUCE Panels</h3>
    <p>A REDUCE panel consists of two panes one above the other. The
    top pane displays all the REDUCE input and output in the current
    session. It is read-only. The bottom pane is an input editor that
    supports all the standard keyboard and mouse-based editing
    facilities normally provided by your platform. It is disabled
    unless REDUCE is running in this panel. Both panes display
    vertical and horizontal scroll bars when necessary. Text does not
    wrap. The horizontal divider separating the two panes can be
    dragged up and down.
    </p>
    <p>The name of the currently running (or last run) REDUCE command
    is appended to the label of the REDUCE input/output display
    pane. (You can edit the command names in
    the <a href="#Configure">REDUCE configuration dialogue</a>.)
    </p>
    <p>You type (or paste) REDUCE input into the input editor pane,
    edit it as necessary, and then click on the <em>Send Input</em>
    button, which sends the input to REDUCE and echos it in the top
    pane. This clears the input editor, but you can scroll through the
    previous input (entered via the input editor) using
    the <em>Earlier Input</em> and <em>Later Input</em>
    buttons. Scrolling to input later than the last previous input
    clears the input editor pane back to its state before you started
    scrolling.
    </p>
    <p>When keyboard focus is in the input editor pane, the following
    keyboard shortcuts are active:
    </p>
    <table>
        <thead>
            <tr>
                <th>Keyboard Shortcut</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><em>Control+Enter</em></td>
                <td>Send Input (auto-terminated)</td>
            </tr>
            <tr>
                <td><em>Control+Shift+Enter</em></td>
                <td>Send Input (not auto-terminated)</td>
            </tr>
            <tr>
                <td><em>Control+UpArrow</em></td>
                <td>Earlier Input</td>
            </tr>
            <tr>
                <td><em>Control+DownArrow</em></td>
                <td>Later Input</td>
            </tr>
        </tbody>
    </table>
    <p>where <em>Enter</em> is the <em>Return</em> or <em>Enter</em>
    key and <em>UpArrow</em> / <em>DownArrow</em> are the cursor up /
    down keys, respectively.
    </p>
    <p>Sending input to REDUCE strips any trailing white space,
    normally auto-terminates it by adding a semicolon if there was no
    final terminator, and then adds a final newline. However, if
    Run-REDUCE-FX detects a question mark in the input prompt then it
    suppresses auto-termination (so if you really want a terminator
    you must enter it explicitly). As an additional precaution,
    holding the <em>Shift</em> key while clicking on the <em>Send
    Input</em> button or pressing <em>Control+Enter</em> always
    suppresses auto-termination.
    </p>
    <p>You can edit previous input recalled into the input editor as
    necessary and then send it to REDUCE. Input can be multi-line, in
    which case Run-REDUCE-FX processes all the lines
    together. The <em>Send Input</em> action is disabled unless
    REDUCE is running, and the <em>Earlier Input</em>
    and <em>Later Input</em> actions are disabled unless there is
    earlier or later input, respectively.
    </p>

    <h2>The File Menu</h2>

    <p>Some items in this menu pop up a dialogue that allows you to
    select one or more items, such as filenames. This dialogue
    supports all the standard keyboard and mouse-based selection
    facilities normally provided by your platform. In particular, in
    dialogues that allow selection of multiple items, holding
    the <em>Control</em> key down while clicking on an item selects or
    deselects it without affecting any other selections, and holding
    a <em>Shift</em> key down while clicking on an item extends the
    selection to that item. Double-clicking on an item selects it and
    then immediately runs the action associated with the confirmation
    button.
    </p>
    <p>Most of the menu items run a REDUCE command, which is echoed in
    the display pane but does not appear in the input editor. The file
    chooser dialogues all share the same default directory, which
    normally is initially your home directory, but the last directory
    you used will be the default directory the next time you use a
    file chooser dialogue. This default directory is independent of
    REDUCE's default directory, which is irrelevant because
    Run-REDUCE-FX always uses absolute file paths.
    </p>
    <p>The File menu provides the following items:</p>
    <h3>Echo File Input</h3>
    <p>Selecting this causes Run-REDUCE-FX to echo file input to
    the <em>Input/Output Display</em> pane. It is selectd by
    default.</p>
    <h3>Input from Files...</h3>
    <p>This displays a file chooser that allows you to choose one or
    more source code files to input into REDUCE (using the
    REDUCE <code>IN</code> command).  By default, the file chooser
    shows only <code>*.red</code> and <code>*.tst</code> files, but
    you can reset it to show only <code>*.txt</code> files or all
    files. (Note that the recommended extension for REDUCE source code
    file names is <code>.red</code> and that a REDUCE source code file
    should end with <code>;end;</code> to avoid an error message.)
    This menu item is disabled unless REDUCE is running.
    </p>
    <h3>Input Package Files...</h3>
    <p>This works the same as the previous menu item except that the
    initial directory is always the REDUCE packages directory. It is
    primarily intended to provide easy access to the package test
    files.
    </p>
    <h3>Output to New File...</h3>
    <p>This displays a file chooser that allows you to choose a file
    to send output to instead of the GUI (using the
    REDUCE <code>OUT</code> command). By default, the file chooser
    shows only <code>*.log and *.rlg</code> files, but you can reset
    it to show only <code>*.txt</code> files or all files. (Note that
    the extension used for REDUCE package test output log file names
    is <code>.rlg</code>.) Only one output file can be active at a
    time and choosing a new output file redirects output to that file
    without shutting the previous output file. The GUI remember all
    the open output files (opened via this menu item) to facilitate
    switching or shutting output files as described below. This menu
    item is disabled unless REDUCE is running.
    </p>
    <h3>Output to Open File...</h3>
    <p>This displays a list of open output files and allows you to
    select one for output. This menu item is disabled unless there are
    open output files.</p>
    <h3>Output Here</h3>
    <p>This redirects output to the GUI without shutting the current
    output file (using the REDUCE <code>OUT T</code> command). This
    menu item is disabled unless there are open output files.
    </p>
    <h3>Shut Output Files...</h3>
    <p>This displays a list of open output files and allows you to
    select one or more to be shut (using the REDUCE <code>SHUT</code>
    command). This menu item is disabled unless there are open output
    files.</p>
    <h3>Shut Last Output File</h3>
    <p>This shuts the last used open output file (using the
    REDUCE <code>SHUT</code> command). This menu item is disabled
    unless there are open output files.
    </p>
    <h3>Load Packages...</h3>
    <p>This displays a list of standard REDUCE packages and allows you
    to select one or more to load (using the
    REDUCE <code>LOAD_PACKAGE</code> command). The list excludes
    packages that are pre-loaded and is sorted
    alphabetically. Run-REDUCE-FX determines the list of packages each
    time it starts up by reading the <code>package.map</code> file in
    the REDUCE installation. This menu item is disabled unless REDUCE
    is running.
    </p>
    <h3>Save Session Log...</h3>
    <p>This displays a file chooser that allows you to specify a file
    to which to save the entire contents of the <em>Input/Output
    Display</em> pane. By default, the file chooser shows
    only <code>*.log</code> and <code>*.rlg</code> files, but you can
    reset it to show only <code>*.txt</code> files or all files. If
    the specified file already exists then the session log overwrites
    its previous content.
    </p>
    <h3>Append Session Log...</h3>
    <p>This works the same as the previous menu item except that if
    the specified file exists then the session log is appended to its
    previous content.</p>
    <h3>Exit</h3>
    <p>This terminates both REDUCE and the Run-REDUCE-FX GUI, as does
    the close widget that is normally at the top right-hand corner of
    the main window frame.
    </p>

    <h2>The REDUCE Menu</h2>

    <p>The REDUCE menu provides the following items:</p>
    <h3>Run REDUCE...</h3>
    <p>This sub-menu provides an item for each configured REDUCE
    command (typically based on different versions of Lisp, by default
    CSL and PSL). Clicking on a REDUCE command runs it. This sub-menu
    is disabled when REDUCE is running.
    </p>
    <h3>Auto-run REDUCE...</h3>
    <p>This sub-menu allows you to select a REDUCE command that
    Run-REDUCE-FX will run automatically when it starts, or
    none. Run-REDUCE-FX remembers this selection and uses it the next
    time it starts. If REDUCE is not running then Run-REDUCE-FX also
    runs the selected REDUCE command immediately.
    </p>
    <h3>Stop REDUCE</h3>
    <p>This terminates REDUCE but <strong>not</strong> the
    Run-REDUCE-FX GUI. <strong>It is the recommended way to stop
    REDUCE because then Run-REDUCE-FX reliably knows that REDUCE is no
    longer running.</strong> (Run-REDUCE-FX tries to detect input of
    the <code>BYE</code> and <code>QUIT</code> commands via the input
    editor, but this may be less reliable.) This menu item is disabled
    unless REDUCE is running.
    </p>
    <h3>Clear I/O Display</h3>
    <p>This completely erases the content of the <em>Input/Output
    Display</em> pane. If you want to keep the content, use
    the <em>Save / Append Session Log...</em> item on
    the <em>File</em> menu before clearing!
    </p>
    <h3 id="Configure">Configure REDUCE...</h3>
    <p>This displays a dialogue that allows you to configure the
    REDUCE directories and commands. The platform defaults should work
    for Microsoft Windows and Linux.  Run-REDUCE-FX currently assumes
    that if it is not running on Windows then the Linux default
    configuration is appropriate, so that is what you will see by
    default on (say) Apple MacOS. There is a button to reset the whole
    REDUCE configuration to the platform defaults.
    </p>
    <p>Changes made using this dialogue are saved when you click on
    the <em>Save</em> button, in which case the new configuration is
    used within Run-REDUCE-FX and saved as preferences. Clicking on
    the <em>Cancel</em> button causes all changes made since the
    dialogue opened to be forgotten.
    </p>
    <p>Clicking on the <em>Delete Selected Command</em> button
    deletes the configuration for the selected REDUCE command. If you
    delete all available commands then a new (empty) command is
    automatically created.
    </p>
    <p>Clicking on the <em>Duplicate Selected Command</em> button
    duplicates the configuration for the selected REDUCE command
    immediately below it in the list.  The name of the duplicate
    command is the name of the duplicated command with <em>New</em>
    appended, which you can edit as you wish. (But keep command names
    fairly short!). Changes to the <em>Command Name</em> field are
    reflected in the list of REDUCE commands only when you press Enter
    (or click on the <em>Save</em> button). This provides a convenient
    way, for example, to add one or more REDUCE commands with
    non-standard options such as memory size.
    </p>
    <p>Clicking on the <em>Add New Command</em> button adds a new
    REDUCE command, which is initially called <em>New Command</em>,
    with all other fields empty. You could, for example, add one or
    more commands running REDUCE on Common Lisp. (At some future date
    I may include CL REDUCE in the default configuration.)
    </p>
    <p>A complete REDUCE command must be split into an executable
    command path name and a sequence of up to 5 command arguments. (It
    would be easy to increase this limit, but I hope 5 arguments is
    enough!)  The components of the command that would be separated by
    white space in a shell command must be entered into separate
    fields on this form. (Blank arguments are ignored.)  Run-REDUCE-FX
    does not currently use a shell to run REDUCE and the command
    specified is used directly to create a separate process to run
    REDUCE. So do not include any shell escapes or other shell syntax!
    You can use absolute path names if you want, but often (as with
    the PSL REDUCE executable and image file names) command components
    share a common root segment. This root segment can be specified
    as <code>$REDUCE</code>, which Run-REDUCE-FX will replace with the
    value of the <em>Command Root Directory</em> field if it is set,
    or with the value of the <em>REDUCE Root Directory</em> field
    otherwise. (I have borrowed environment variable syntax,
    but <code>$REDUCE</code> here is not related to any environment
    variable.)
    </p>
    <p>The two default REDUCE commands, which assume standard
    installations of CSL and PSL REDUCE, share the same root
    directory, which is why the default configuration uses <em>REDUCE
    Root Directory</em> and leaves <em>Command Root Directory</em>
    empty. But a version of REDUCE running on Common Lisp would
    probably use a different root directory.
    </p>
    <p>The <em>Load Packages...</em> facility in the <em>File</em>
    menu requires a standard REDUCE packages directory, which
    should <strong>exist in the directory</strong> specified by
    the <em>Packages Root Directory</em> field.  The value of
    the <em>Packages Root Directory</em> field is only used
    by <em>Load Packages...</em>. If this directory does not exist or
    is mis-configured then <em>Load Packages...</em> will pop up a
    warning and closing it will automatically pop up the <em>Configure
    REDUCE...</em> dialogue to allow you to correct the problem.
    </p>
    <p>The <em>Help</em> menu items that display REDUCE documentation
    require the common root segment of the directories containing the
    distributed documentation files to be specified as the value of
    the <em>Documentation Root Dir</em> field. (On Microsoft Windows
    the documentation files are stored in several directories that
    share a common root segment, but on other platforms they are all
    stored in the same directory.)
    </p>
    <p>The two directories described above relate to the portable
    REDUCE source code and are independent of particular REDUCE
    implementations, so they are fixed for all REDUCE commands.
    </p>
    <p>All field values are stripped of leading and trailing space
    before they are used or saved, and empty fields are not saved at
    all.  Where appropriate, text fields have a button beside them
    labelled "...".  This button displays a directory or file chooser
    that can be used to set the field (which can then be edited
    further). The initial directory used by the directory or file
    chooser is the appropriate platform default.
    </p>

    <h2 id="ViewMenu">The View Menu</h2>

    <p>The View menu provides the following items:</p>
    <h3>Font Size...</h3>
    <p>This displays a dialogue that allows you to change the font
    size used in the <em>Input/Output Display</em> and <em>Input
    Editor</em> panes.  Run-REDUCE-FX remembers the selected size and
    uses it the next time you start Run-REDUCE-FX.
    </p>
    <h3>Bold Prompts</h3>
    <p>Selecting this item causes Run-REDUCE-FX to embolden the
    display of all input prompts. (This works independently of any I/O
    colouring but does not take effect until the <strong>next</strong>
    input prompt.)
    </p>
    <h3>I/O Colouring</h3>
    <p>This sub-menu allows you to select an I/O colouring
    option: <em>None</em>, <em>Modal</em>
    or <em>Redfront</em>. <em>Modal</em> colouring depends on REDUCE's
    current input mode: algebraic-mode prompts and input are red,
    algebraic-mode output is blue, symbolic-mode prompts and input are
    brown, symbolic-mode output is purple. <em>Redfront</em> colouring
    is intended to provide a full emulation of the standard
    REDUCE <em>redfront</em> facility and it loads
    the <em>redfront</em> package (silently), which outputs additional
    markup that is interpreted by Run-REDUCE-FX in the same way that
    it is normally interpreted by the <em>redfront</em> executable
    running in a suitable terminal (emulator). With <em>Redfront</em>
    colouring, all prompts and interactive input are red,
    algebraic-mode output is blue, and echoed file input and
    symbolic-mode output are not coloured. Note that
    turning <em>Redfront</em> colouring on or off does not take effect
    until REDUCE is (re-)started, and turning <em>Modal</em> colouring
    on or off does not fully take effect until the next input prompt.
    </p>
    <h3>Single Pane Display</h3>
    <p>Selecting this causes Run-REDUCE-FX to display the selected
    REDUCE panel only. This is the default.
    </p>
    <h3>Split Pane Display</h3>
    <p>Selecting this causes Run-REDUCE-FX to display two REDUCE
    panels side-by-side. The left-hand panel displays the previously
    selected REDUCE panel (if any) and is initially active. Clicking
    on a REDUCE panel makes it active for input via its input editor
    pane and the menus. The inactive REDUCE panel can continue to
    update its output display. Both panels are the same size
    initially, but you can change that by dragging the divider.
    </p>
    <h3>Tabbed Pane Display</h3>
    <p>Selecting this causes Run-REDUCE-FX to display a tabbed pane
    with the previously selected REDUCE panel (if any) displayed under
    the first tab.  Clicking on the <code>&times;</code> icon at the
    right of the selected tab label removes that tab and the REDUCE
    panel it contains. When there is only one tab, removing it
    disables tabbed display but preserves the REDUCE panel that the
    tab contained.
    </p>
    <h3>Add Another Tab</h3>
    <p>This adds a new tab to a tabbed display.  This menu item is
    disabled unless tabbed pane display is selected.
    </p>

    <h2>The Help Menu</h2>

    <p>All the documents accessed via the Help menu are local files.
    The Help menu provides the following items:</p>
    <h3>Run-REDUCE-FX User Guide</h3>
    <p>This opens the Run-REDUCE-FX User Guide in your default web
    browser.  It is extracted from the Java JAR file at most once per
    run of Run-REDUCE-FX to your default temporary directory.
    </p>
    <h3>REDUCE Manual etc.</h3>
    <p>On Microsoft Windows, these menu items open the manuals and
    other guides that are distributed with REDUCE in your default web
    browser or PDF viewer, as appropriate.  On other platforms, only
    the HTML version of the REDUCE Manual is available at present.
    The files are assumed to be available in your REDUCE installation.
    </p>
    <h3>About Run-REDUCE-FX</h3>
    <p>This pops up brief information about Run-REDUCE-FX.</p>
</body>
</html>
