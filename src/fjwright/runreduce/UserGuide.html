<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
    <title>Run-REDUCE-FX User Guide</title>
    <style type="text/css">
        body {
            font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif;
        }
        code {
            font-family: "DejaVu Sans Mono";
        }
        h1, h2, h3 {
            font-family: Cambria, Cochin, Georgia, Times, "Times New Roman", serif;
        }
    	table {
			margin-right: auto;
			margin-left: auto;
		}
		td,th {
			padding-right: 10px;
			padding-left: 10px;
			text-align: left;
		}
    </style>
</head>
<body>
    <h1>Run-REDUCE-FX User Guide</h1>
    <h3>Francis Wright, May 2020</h3>
    <h2>General Information</h2>
    <p>Run-REDUCE-FX remembers user preferences and uses them the next
    time it starts. It uses the standard Java
    package <a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.prefs/java/util/prefs/package-summary.html">java.util.prefs</a>,
    which stores data persistently in an implementation-dependent
    backing store. On Microsoft Windows the preferences for this
    application are stored in the registry under the
    key <code>Computer\HKEY_CURRENT_USER\Software\JavaSoft\Prefs\fjwright\runreduce</code>
    and on Ubuntu Linux they are stored in the XML
    file <code>~/.java/.userPrefs/fjwright/runreduce/prefs.xml</code>.
    </p>
    <p>By default, Run-REDUCE-FX looks in the standard places for a
    REDUCE installation. On Microsoft Windows it looks for the
    folder <code>\Program Files\Reduce</code> on all accessible
    drives. On Ubuntu Linux it assumes that executable files are
    under <code>/usr/lib/reduce</code>, package information is
    under <code>/usr/share/reduce</code>, and documentation is
    under <code>/usr/share/doc/reduce</code>. But this information can
    all be <a href="#Configure">reconfigured</a>.
    </p>
    <h2>The Main Window</h2>
    <p>The main window consists of one or more REDUCE panels that can
    each run an independent invocation of REDUCE. There are three
    options: a single REDUCE panel (the default); a split pane
    containing two REDUCE panels side-by-side that are both visible; a
    tabbed pane containing one or more REDUCE panels, of which only
    the selected panel is visible. The choice of display pane
    arrangements is controlled by radio buttons in
    the <a href="#ViewMenu">View menu</a>. You can switch dynamically
    among the three options, in which case the currently selected
    REDUCE panel (only) and the REDUCE invocation running in it (if
    any) is preserved and carried to the new display pane arrangement,
    but any other REDUCE invocations are discarded. With a split or
    tabbed pane, the active REDUCE panel can be selected by clicking
    on the desired panel in a split pane or tab on a tabbed pane. The
    non-selected panel in a split pane is greyed out. All controls and
    the File and REDUCE menus apply to the currently selected REDUCE
    panel, whereas the View menu applies to all REDUCE panels.
    </p>
    <p>Tabs are initially labelled <em>Tab 1</em>, <em>Tab 2</em>,
    etc., and a new tab is labelled <em>Tab n</em> if it is
    the <em>nth</em> tab to be added. (Removing tabs does not affect
    the numbering.) However, when REDUCE is run in a tab, the tab
    label changes to the name of the REDUCE command being run, and
    remains so until a different REDUCE command is run in that tab.
    </p>
    <h3>REDUCE Panels</h3>
    <p>A REDUCE panel consists of two panes one above the other. The
    top pane displays a log of all the REDUCE input and output in the
    current session. This pane is read-only. The bottom pane is an
    input editor that supports all the standard keyboard and
    mouse-based editing facilities normally provided by your
    platform. Both panes display vertical and horizontal scroll bars
    when appropriate; text does not wrap. The horizontal divider
    separating the two panes can be dragged up and down.
    </p>
    <p>The name of the currently running (or last run) REDUCE command
    is appended to the label of the REDUCE input/output display
    pane. (You can edit the command names in
    the <a href="#Configure">REDUCE configuration dialogue</a> if you
    don't like the default names.)
    </p>
    <p>You type (or paste) REDUCE input into the input editor pane,
    edit it as necessary, and then click on the <code>Send
    Input</code> button, which sends the input to REDUCE and echos it
    in the top pane. This clears the input editor, but you can scroll
    through the previous input entered via the input editor using
    the <code>Earlier Input</code> and <code>Later Input</code>
    buttons. Scrolling to input later than the last previous input
    clears the input editor pane back to its state before you started
    scrolling.
    </p>
    <p>When keyboard focus is in the input editor pane, the following
    keyboard shortcuts are active:
    </p>
    <table>
        <thead>
            <tr>
                <th>Keyboard Shortcuts</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><em>Control+Enter</em></td>
                <td>Send Input (auto-terminated)</td>
            </tr>
            <tr>
                <td><em>Control+Shift+Enter</em></td>
                <td>Send Input (no auto-termination)</td>
            </tr>
            <tr>
                <td><em>Control+UpArrow</em></td>
                <td>Earlier Input</td>
            </tr>
            <tr>
                <td><em>Control+DownArrow</em></td>
                <td>Later Input</td>
            </tr>
        </tbody>
    </table>
    <p>where <em>Enter</em> is the <em>Return</em> or <em>Enter</em>
    key and <em>UpArrow</em> / <em>DownArrow</em> are the cursor up /
    down keys, respectively.
    </p>
    <p>You can edit previous input recalled into the input editor as
    necessary and then send it to REDUCE. Input can be multi-line, in
    which case Run-REDUCE-FX processes all the lines
    together. The <code>Send Input</code> action is disabled unless
    REDUCE is running, and the <code>Earlier Input</code>
    and <code>Later Input</code> actions are disabled unless there is
    earlier or later input, respectively.
    </p>
    <p>Sending input to REDUCE strips any trailing white space,
    normally auto-terminates it by adding a semicolon if there was no
    final terminator, and then adds a final newline. However, if
    Run-REDUCE-FX detects a question mark in the input prompt then it
    suppresses auto-termination (so if you really want a terminator
    you must enter it explicitly). As an additional precaution,
    holding the <em>Shift</em> key while
    pressing <em>Control+Enter</em> or clicking on the <code>Send
    Input</code> button always suppresses auto-termination.
    </p>
    <h2>The File Menu</h2>
    <p>Some items in this menu pop up a dialogue that allows you to
    select one or more items, such as filenames. This dialogue
    supports all the standard keyboard and mouse-based selection
    facilities normally provided by your platform. In particular, in
    dialogues that allow selection of multiple items, holding
    the <code>Control</code> key down while clicking on an item
    selects or deselects it without affecting any other selections,
    and holding a <code>Shift</code> key down while clicking on an
    item extends the selection to that item. Double-clicking on an
    item selects it and then runs the action associated with the
    confirmation button.
    </p>
    <p>Most of the menu items run a REDUCE command, which is echoed
    in the display pane but does not appear in the input editor. The
    file selector dialogues all share the same default directory,
    which is initially your home directory, but the last directory you
    used will be the default directory the next time you use a file
    selector dialogue.
    </p>
    <p>This default directory is independent of REDUCE's default
    directory, which is irrelevant because Run-REDUCE-FX always uses
    absolute file paths.
    </p>
    <p>The File menu provides the following items.</p>
    <h3>Echo File Input</h3>
    <p>Selecting this checkbox causes Run-REDUCE-FX to echo file input to the <code>Input/Output Display</code> pane. It is selectd by default.</p>
    <h3>Input from Files...</h3>
    <p>This displays a file selector that allows you to input one or
    more source code files into REDUCE (using the
    REDUCE <code>IN</code> command).  By default, the file selector
    shows only <code>*.red</code> and <code>*.tst</code> files, but
    you can reset it to show only <code>*.txt</code> files or all
    files. (Note that the recommended extension for REDUCE source
    files is <code>.red</code>. and that a REDUCE source code file
    should end with <code>;end;</code> to avoid an error message.)
    This menu item is disabled unless REDUCE is running.
    </p>
    <h3>Input Package Files...</h3>
    <p>This works the same as the previous menu item except that the
    initial directory is always the REDUCE packages directory, which
    is primarily intended to provide easy access to the package test
    files.
    </p>
    <h3>Output to New File...</h3>
    <p>This This displays a file selector that allows you to specify
    a file to send output to instead of the GUI (using the
    REDUCE <code>OUT</code> command). By default, the file selector
    shows only <code>*.log and *.rlg</code> files, but you can reset
    it to show only <code>*.txt</code> files or all files. (Note that
    the recommended extension for REDUCE output files
    is <code>.rlg</code>.) Only one output file can be selected at a
    time, but selecting a new output file redirects output to that
    file without shutting the previous output file. The GUI remember
    all the open output files (opened via this menu item) to
    facilitate switching or shutting output files; see below. This
    menu item is disabled unless REDUCE is running.
    </p>
    <h3>Output to Open File...</h3>
    <p>This This displays a list of open output files and allows you to select one for output. It is disabled unless REDUCE is running and there are open output files.</p>
    <h3>Output Here</h3>
    <p>This redirects output to the GUI without shutting the current
    output file (using the REDUCE <code>OUT T</code> command). It is
    disabled unless REDUCE is running and there are open output files.
    </p>
    <h3>Shut Output Files...</h3>
    <p>This displays a list of open output files and allows you to select one or more to be shut (using the REDUCE <code>SHUT</code> command). It is disabled unless REDUCE is running and there are open output files.</p>
    <h3>Shut Last Output File</h3>
    <p>This shuts the last used open output file (using the
    REDUCE <code>SHUT</code> command). It is disabled unless REDUCE is
    running and there are open output files.
    </p>
    <h3>Load Packages...</h3>
    <p>This displays a list of standard REDUCE packages and allows
    you to select one or more to be loaded (using the
    REDUCE <code>LOAD_PACKAGE</code> command). The list excludes
    packages that are pre-loaded and is sorted
    alphabetically. Run-REDUCE-FX determines the list of packages each
    time it starts up by reading the <code>package.map</code> file in
    the REDUCE installation. This menu item is disabled unless REDUCE
    is running.
    </p>
    <h3>Save Session Log...</h3>
    <p>This This displays a file selector that allows you to specify
    a file to which to save the entire contents of
    the <code>Input/Output Display</code> pane. By default, the file
    selector shows only <code>*.log and *.rlg</code> files, but you
    can reset it to show only <code>*.txt*.txt</code> files or all
    files. If the specified file already exists then the session log
    overwrites its previous content.
    </p>
    <h3>Append Session Log...</h3>
    <p>This works the same as the previous menu item except that if
    the specified file exists then the session log is appended to its
    previous content.</p>
    <h3>Exit</h3>
    <p>This terminates both REDUCE and the Run-REDUCE-FX GUI, as does
    the close widget that is normally at the top right-hand corner of
    the main window frame.
    </p>
    <h2>The REDUCE Menu</h2>
    <p>The REDUCE menu provides the following items.</p>
    <h3>Run REDUCE...</h3>
    <p>This sub-menu provides an item for each configured REDUCE
    command (typically based on different versions of Lisp &ndash; by
    default CSL and PSL). Clicking on a REDUCE command runs it. This
    sub-menu is disabled when REDUCE is running.
    </p>
    <h3>Auto-run REDUCE...</h3>
    <p>This sub-menu allows you to select a REDUCE command that
    Run-REDUCE-FX will run automatically when it starts, or
    none. Run-REDUCE-FX remembers this selection and uses it the next
    time it starts. If REDUCE is not running then Run-REDUCE-FX also
    runs the selected REDUCE command immediately.
    </p>
    <h3>Stop REDUCE</h3>
    <p>This terminates REDUCE but <strong>not</strong> the
    Run-REDUCE-FX GUI. <strong>It is the recommended way to stop
    REDUCE because then Run-REDUCE-FX reliably knows that REDUCE is no
    longer running.</strong> (Run-REDUCE-FX tries to detect input of
    the <code>BYE</code> and <code>QUIT</code> commands via the input
    editor, but this is less reliable.) This menu item is disabled
    unless REDUCE is running.
    </p>
    <h3>Clear I/O Display</h3>
    <p>This completely erases the content of the <code>Input/Output
    Display</code> pane. If you want to keep the content, use
    the <code>Save / Append Session Log...</code> item on
    the <code>File</code> menu before clearing!
    </p>
    <h3 id="Configure">Configure REDUCE...</h3>
    <p>This displays a dialogue that allows you to configure the
    REDUCE directories and commands. The platform defaults should work
    for Microsoft Windows and Ubuntu Linux.  Run-REDUCE-FX currently
    assumes that if it is not running on Windows then the Ubuntu
    default configuration is appropriate, so that is what you will see
    by default on (say) Apple MacOS. There is a button to reset the
    whole REDUCE configuration to the platform defaults.
    </p>
    <p>Changes to the dialogue fields are only saved if you click on
    the <code>Save</code> button, in which case the new configuration
    is used within Run-REDUCE-FX and saved as preferences. Clicking on
    the <code>Cancel</code> button causes all changes made since the
    dialogue box opened to be forgotten.
    </p>
    <p>Clicking on the <code>Delete Selected Command</code> button
    deletes the configuration for the selected REDUCE command. If you
    delete all available commands then a new (empty) command is
    automatically created.
    </p>
    <p>Clicking on the <code>Duplicate Selected Command</code> button
    duplicates the configuration for the selected REDUCE command
    immediately below it.  The name of the duplicate command is the
    name of the duplicated command with <code>New</code> appended,
    which you can edit as you wish. (But keep command names fairly
    short!). Changes to the <code>Command Name</code> field are
    reflected in the list of REDUCE commands only when you press Enter
    (or click on the <code>Save</code> button). This provides a
    convenient way, for example, to add one or more REDUCE commands
    with non-standard options such as memory size.
    </p>
    <p>Clicking on the <code>Add a New Command</code> button adds a
    new REDUCE command, which is initially called <code>New
    Command</code>, with all other fields empty. You could, for
    example, add one or more REDUCE commands running on Common
    Lisp. (At some future date I may include CL REDUCE in the default
    configuration.)
    </p>
    <p>A full REDUCE command must be split into an executable command
    filename and a sequence of up to 5 command arguments. (It would be
    easy to increase this limit, but I hope 5 arguments is enough!)
    The components of the command that would be separated by white
    space in a shell command must be entered into separate fields on
    this form. Run-REDUCE-FX does not currently use a shell to run
    REDUCE and the command specified is used directly to create a
    separate process to run REDUCE. So do not include any shell
    escapes or other shell syntax! You can use absolute file pathnames
    if you want, but often (as with the PSL REDUCE executable and
    image file names) command components share a common root
    segment. This root segment can be specified
    as <code>$REDUCE</code>, which Run-REDUCE-FX will replace with the
    value of the <code>Command Root Directory</code> field if it is
    set, or with the value of the <code>REDUCE Root Directory</code>
    field otherwise. (I have borrowed environment variable syntax,
    but <code>$REDUCE</code> here is not related to any environment
    variable.)
    </p>
    <p>The two REDUCE commands that are distributed, namely CSL and
    PSL REDUCE, share the same root directory, which is why the
    default configuration uses <code>REDUCE Root Directory</code> and
    leaves <code>Command Root Directory</code> empty. But a version of
    REDUCE running on Common Lisp would probably use a different root
    directory.
    </p>
    <p>The <code>Load Packages...</code> facility in
    the <code>File</code> menu requires a standard REDUCE packages
    directory, which should exist in the directory specified by
    the <code>Packages Root Directory</code> field. The information
    used is independent of the REDUCE implementation, so this
    directory is fixed for all REDUCE versions. It is normally
    associated with the portable REDUCE source code. The value of
    the <code>Packages Root Directory</code> field is only used
    by <code>Load Packages...</code>. If this directory does not exist
    or is mis-configured then <code>Load Packages...</code> will pop
    up a warning dialogue, and closing this will automatically pop up
    the <code>Configure REDUCE...</code> dialogue to allow you to
    correct the problem.
    </p>
    <p>The <code>Help</code> menu items that display REDUCE
    documentation require the common root segment of the directories
    containing the distributed documentation files to be specified as
    the value of the <code>Documentation Root Dir</code> field. (On
    Microsoft Windows the documentation files are all stored in the
    same directory, but on other platforms they are stored in several
    directories that share a common root segment.)
    </p>
    <p>All field values are stripped of leading and trailing space
    before they are used or saved, and empty fields are not saved at
    all.  Where appropriate, text fields have a button beside them
    labelled "&hellip;".  This button displays a directory or file
    chooser that can be used to set the field (which can then be
    edited further). The initial directory used by the directory or
    file chooser is the appropriate platform default.
    </p>
    <h2 id="ViewMenu">The View Menu</h2>
    <p>The View menu provides the following items.</p>
    <h3>Font Size...</h3>
    <p>This displays a dialogue box that allows you to change the
    font size used in the <code>Input/Output Display</code>
    and <code>Input Editor</code> panes.  Run-REDUCE-FX remembers the
    selected size and uses it the next time you start Run-REDUCE-FX.
    </p>
    <h3>Bold Prompts</h3>
    <p>Selecting this checkbox causes Run-REDUCE-FX to embolden the
    display of all input prompts. (This works independently of any I/O
    colouring but does not take effect until the <strong>next</strong>
    input prompt.)
    </p>
    <h3>I/O Colouring</h3>
    <p>This sub-menu allows you to select an I/O colouring
    option: <code>None</code>, <code>Modal</code>
    or <code>Redfront</code>. Modal colouring depends on REDUCE's
    current input mode: algebraic-mode prompts and input are red,
    algebraic-mode output is blue, symbolic-mode prompts and input are
    brown, symbolic-mode output is purple. Redfront colouring is
    intended to provide a full emulation of the standard
    REDUCE <code>redfront</code> facility and it loads
    the <code>redfront</code> package (silently), which outputs
    additional markup that is interpreted by Run-REDUCE-FX in the same
    way that it is normally interpreted by the <code>redfront</code>
    executable running in a suitable terminal (emulator). In Redfront
    mode all prompts and interactive input are red, algebraic-mode
    output is blue, and echoed file input and symbolic-mode output are
    not coloured. Note that turning Redfront mode on or off does not
    take effect until REDUCE is (re-)started, and turning other modes
    on or off does not fully take effect until the next input prompt.
    </p>
    <h3>Single Pane Display</h3>
    <p>Selecting this radio button causes Run-REDUCE-FX to display
    the selected REDUCE panel only. This is the default.
    </p>
    <h3>Split Pane Display</h3>
    <p>Selecting this radio button causes Run-REDUCE-FX to display
    two REDUCE panels side-by-side. The left-hand panel displays the
    selected REDUCE panel and is initially active. Clicking on a
    REDUCE panel makes it active for input via its input editor pane
    and the menus. The inactive REDUCE panel can continue to update
    its output display. Both panels are the same size initially, but
    you can change that by dragging the divider or clicking on one of
    the two triangular icons at the top.
    </p>
    <h3>Tabbed Pane Display</h3>
    <p>Selecting this radio button causes Run-REDUCE-FX to display a
    tabbed pane with the selected REDUCE panel displayed under the
    first tab.  Clicking on the rightmost tab labelled <code>+</code>
    adds a new tab immediately to the left of the <code>+</code>
    tab. Clicking on the <code>X</code> icon at the right of any tab
    title removes that tab and the REDUCE panel it contains. When
    there is only one tab, removing it disables tabbed display but
    preserves the REDUCE panel that the tab contained.
    </p>
    <h3>Add Another Tab</h3>
    <p>This adds a new tab to a tabbed display, just like
    the <code>+</code> tab. When tabbed display is disabled, this menu
    item enables tabbed display and adds a <strong>second</strong>
    tab, as it would if tabbed display were already enabled. Hence
    this menu item is enabled when either single or tabbed pane
    display is selected.
    </p>
    <h3>Remove Selected Tab</h3>
    <p> This removes the selected tab and the REDUCE panel it
    contains, just like the <code>X</code> icon. When there is only
    one tab, this menu item reverts to single pane display but
    preserves the REDUCE panel that the tab contained. This menu item
    is disabled unless tabbed display is selected.
    </p>
    <h2>The Help Menu</h2>
    <p>The Help menu provides the following items.</p>
    <h3>Run-REDUCE-FX User Guide</h3>
    <p>This opens the Run-REDUCE-FX User Guide in a separate window.
    </p>
    <h3>REDUCE Manual etc.</h3>
    <p>These menu items open the manuals and other guides that are
    distributed with REDUCE in your default web browser or PDF viewer,
    as appropriate.
    </p>
    <h3>About Run-REDUCE-FX</h3>
    <p>This pops up a dialogue displaying brief information about Run-REDUCE-FX.</p>
</body>
</html>
